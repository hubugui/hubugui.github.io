---
layout: post
title: ToB项目上线综合症                            # Title of the page
hide_title: false                                   # Hide the title when displaying the post, but shown in lists of posts
# feature-img: "assets/img/sample.png"              # Add a feature-image to the post
# thumbnail: "assets/img/stb_background.png"        # Add a thumbnail image on blog view
# color: rgb(80,140,22)                             # Add the specified color as feature image, and change link colors in post
bootstrap: true                                     # Add bootstrap to the page
published: true
tags: [故障]
excerpt_separator: <!--more-->
---

<!--more-->
* TOC
{:toc}

# 1. 现象

有一次写了几百行的短信网关，下午去用户现场参加上线马拉松(软件集成商和设备厂商的代表一起驻场、连轴转，直到用户代表满意)，因为据说第二天用户的全国客户就要使用短信报名。到晚上集成商的系统对接后发现协议有问题，改到21点，现场二十号人开始发动自己的朋友圈发短信测试：给每个人说发什么到XXX号码，收到什么是对的。开始时挺好，陆陆续续出现很多人没收到报名结果的短信。一番拳脚，最后定位到短信平台对服务号码的测试流量做了限制，已是凌晨3点。我趴桌子睡到5点，隔壁厂商的VBer一直在找短信内容太长会丢失的原因，最后大伙直到下午才回去，那名VBer据说后来被毕业了。

做过ToB项目的朋友都熟悉这种上线的煎熬，看上去小项目的投入少、情有可原，其实大中型ToB项目的翻车也不少见。

# 2. 翻车表演

### 表演

1. 系统不是期望的型号和版本，补丁包装不上。
2. 开机启动不奏效。
3. XXX功能，运行结果明显不符合事实。
4. XXX功能，每到夜间3点不能用，有时自动恢复，有时只能重启机器。
5. 没有承诺的XXX功能。
6. 和第三方系统对接不成功。
7. 第三方系统故障，导致我方无法正常工作。

用户是翻车表演的资深观众，一看势头不对，投诉飞快流转到乙方(某类产品提供商)，产品研发部门的反馈就像小孩口袋中的玩意，五花八门，让现场人员震惊，下面把反馈划分为几类：

### 部署

1. 没在Fedora 37 Server上试过XXX，不能联网升级吗？
2. 是先在A服务器装A1、A2，再去B服务器装B1的吗？装B1时选择了A的地址吗？
3. 杀过毒嘛？你那有安装手册嘛？

### 异常

1. 有50个并发客户端，怎么1台服务器才插了1根网线？
2. 我这跑性能测试用例没问题，现场用的XXX设备测试过性能嘛，网络质量咋样？存储带宽和IOPS咋样？
3. 跟踪2天再现了问题，是系统时间不对导致的。为什么现场NTP同步没生效，最近网络拓扑是不是变了？新防火墙过滤了NTP数据包？

### 功能

1. 没听说要开发这个功能？
2. 这个功能都没开发完，怎么跑去部署了？
3. 这个功能没法和你向用户承诺的另一个功能同时使用！
4. XXX功能要有YYY环境和设备，现场具备吗？
5. 什么，某项功能又要改成上周那个版本？
6. 什么，要改为支持XXX厂家设备？

乙方一到上线才发现无法如期交付，说明感染了**上线综合症**。

# 2. 原因

不幸的家庭各有各的不同，先来看看ToB项目的特点，乙方和不同的行业甲方签署合同项目，合同中普遍承诺：

1. 乙方把实现甲方需求的软硬件产品部署到甲方的私有云环境。
2. 作为1的一部分，乙方对接甲方不同时期的遗留系统。
3. 本次项目依赖的运行环境可能是甲方先前遗留的，也可能是伴随项目计划逐步建设。包括机房、网络、第三方设备，视项目而定，也许还有指定的服务器、PC机、特殊设备。
4. 项目在某个日期开始部署上线，乙方派出实施人员在甲方现场完成软硬件的安装、部署、调测，开始试用，并支持甲方在某个日期验收项目。

而且一个项目中会有多个乙方供应商、多种角色、复杂的软硬件环境，以及一些定制化功能，这些因素的综合影响下，翻车原因也不止一个，几根线头纠缠、互卷，造成了混乱，最后谁也无法全面地掌握目标和质量，对于乙方来说，一场战争的对手在哪里、什么叫赢都不明确，结果自然好不了。

### 2.1. 需求不一致

用户的诉求源自业务痛点和情感期待，如何高效、低成本地转化为一个个可量化的功能，需要高质量的持续沟通，优雅融合内外部资源、项目管理、产品技术解决方案及依赖的基础设施，不是写几个泛泛的设计方案。再讨论讨论就能全面掌控的。下面现象就说明甲方和乙方对于做成什么样，缺乏明确的对齐，会让彼此付出显著的额外成本。

1. 用户和业务专家商讨出想要的东西，在经过多个关联方的传达和展开后变味了，直到上线才知道。
2. 用户想要的，经过实际使用产品后，改变了想法，开始修改需求、加功能，甚至影响到技术解决方案。
3. 用户想要的，存在摸棱两可，一直未能就如何落地达成共识，大家都认为先上线再说，最后双方瞠目结舌。

![先上线](../assets/img/post/first_online.jpg)

4. 有多个用户，每个用户都有自己想要的，存在矛盾，难以全面、合理地捏合到一起。
5. 产品的关键功能和产品间的互操作，做成什么样子，多方没有明确的、统一的认识，直到上线发现相互过高期待，甚至出现重大漏洞。

发生这些现象后，企业的一致做法是迅速从产品研发团队抽调人手，和实施人员组成特种兵，高效配合铺平崎岖的交付道路。但其实不管他们效率如何，这些都是意料之外的成本，不发生问题、少发生问题、只发生低成本修复的问题，才叫高明。**事后不能缺少闭环的精益思考。**

### 2.2. 质量不合格

质量不好，安装和使用困难，这类问题最多，有的很快能解决，有的费时费力。

1. 产品UI体验不好，操作拧巴，留下粗制乱造的映像。
2. 技术解决方案无法支撑现场的环境、数据、使用方式。
3. bug多，测试不充分。
4. 运维成本高，分析现象的时间太长、效率太低。
5. 可靠性不足，换台设备就产品无法使用。

### 2.3. 环境不一致

1. 甲方、甲方运行环境的承建方和乙方，三者没对齐最终环境的详细数据，使得产品研发部门无法按照最终环境做检验。
2. 基于1，产品研发部门不知道在最终环境下需要额外做什么，做多长时间，实施人员更不知道，全体忽略这个环节，导致计划时间不足。

### 2.4. 实施准备不足

实施是实际检验产品的重要阶段，在项目进展的时间线上，晚于需求分析、产品设计、研发和测试。

1. 实施人员不知道这三者的匹配度：用户想要的、产品能提供的、产品依赖的环境。
2. 实施人员临到上线才拿到最终产品，没有充裕时间熟悉产品的安装、使用、排查现象等。
3. 实施人员需要处理诸多现场的事务沟通、会议等计划外的工作。
4. 实施人员缺少分析产品和软硬件环境的运维技能。
5. 实施人员的定位模糊：
  * 我在帮助用户建设一套业务系统？
  * 我是帮助企业的产品研发部门安装系统？

### 2.5. 项目管理不足

大型翻车事故不管涉及哪些业务技能，都是项目管理执行的失败，而不能简单的认为这是某一个部门、某一个角色、某一个人(包括项目经理本人)的事。面对复杂的内外部环境，项目管理更要做好，全面掌握目标、进度、质量，提前预防风险，用低成本的手段实现最大化的价值，才能在错综复杂的ToB环境中脱颖而出。

# 3. 三板斧

试试下面三板斧。

## 3.1. 质量

识别业务部门的职能特点，抓关键点质量：产品有没有和用户对齐功能和运行环境？你们喜欢这样操作吗？开发有没有自测？核心功能有没有自动化测试？测试有没有用例？部署能不能自动化？实施用过产品吗？测试能提供和现场一致的运行环境吗？项目经理知道上面这些问题的答案吗？

其次赋予大家服务意识，把下游同学当用户、当初恋，然后带大家看看高山、看看什么叫作高质量和服务，给每个角色定目标，让每个人都知道虽然允许技能和经验的欠缺，但要有进步。

## 3.2. 流程

同样的方法论，不同的人去执行，结果都不相同，要度量每个角色的输出质量，从而促使团队协作达到 1 + 1 > 2，需要流程来支撑、润滑，力出一孔。

要允许

没有永远的方法，不同企业也

改善沟通方法。

需要警惕的是，从销售、项目、产品、开发、测试到实施，每个角色都是项目不同阶段的一份子，相互之间多谦卑、少挖坑，因为如果你的失误给他人造成了麻烦，不会没有损失，比如典当了自己的声誉。

背后的一些深层次现象也不能忽视：

1. 为什么招聘技能不足的员工？
2. 为什么不能快速提高员工的技能？
3. 为什么这么点事，A虽然做的差一点，B就不能主动沟通、自觉补位吗？
4. 为什么B总是那么多问题？

## 3.3. 组织

由于涉及到很多的不同乙方和特殊环境，首先要设置一位强有力的项目管理角色，内部横向管理，要求他具有全面的技能，最好是技术出身，因为一位没上过前线的参谋制定的作战计划，漏洞百出。

针对某些角色和技能进行专项提高，是团队治理的常见手段，也有很多参考的文章、书籍。从长远看人和环境都会变化、流失，**授人以鱼不如授团队以渔**，搭建一个具备自我运转、自我修复的组织和流程，才是根本皆治的办法。