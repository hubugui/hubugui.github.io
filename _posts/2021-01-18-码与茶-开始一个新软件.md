---
layout: post
title: 码与茶－开始一个新软件                            # Title of the page
hide_title: false                                  # Hide the title when displaying the post, but shown in lists of posts
# feature-img: "assets/img/sample.png"              # Add a feature-image to the post
# thumbnail: "assets/img/stb_background.png"   # Add a thumbnail image on blog view
# color: rgb(80,140,22)                             # Add the specified color as feature image, and change link colors in post
bootstrap: true                                   # Add bootstrap to the page
tags: [码与茶]
excerpt_separator: <!--more-->
---

<!--more-->
* TOC
{:toc}

### 1. 开始的开始

了解开发背景和需求后，先别动手，思考几个问题：

1. 用户是谁？
2. 用户在什么时间、什么场景下，有哪些急需解决的问题？
3. 我要开发的软件功能，把问题解决到什么程度？
4. 用户如何使用我的软件？有哪些限制？软件不应该做什么？
5. 软件是个Demo还是正式使用？
6. 如果初恋是用户，做些什么会更好？

无论商业软件还是开发者的个人软件，定义的源头是场景和技术手段的混合抽象，通过梳理上面问题，在软件启动之初，反复优化抽象过程的结果，帮助团队准确认知目标的价值、背景和约束，让这些底层逻辑溶解成自然反应，支撑后续的每项工程活动、持续思考和改进，投入情感，逐步打造出解决问题、受人喜爱的软件。

#### 1.1. 自然反应

1. 你可能穿睡衣坐地铁，但不会冒着扎伤的危险，光脚去上班。那为什么不避免打开太多窗口导致软件失去响应？
2. 你来不及放下手中咖啡杯，直接用它挡住了飞来的足球。那为什么在检测到即将失去响应时没有提示关闭高消耗功能的操作方法？
3. 你初次约会时理发、刮胡子。那为什么软件难用，看上去用户下单成功，获取物流状态却不及时，寻找商户电话要点击5个按钮，如同理发不洗头。
4. 你留给朋友的手机号永远能打通。那为什么耦合设计多个子系统的状态依赖，导致给某个子系统发送命令后有时有响应、有时没响应？

#### 1.2. 情感

你有幸加入了**哈尔**机器人团队，哈尔的使命之一是驾驶飞船登月，如果设计者没有为哈尔加入任何时候都不可以伤害人类的前提，开发者照本宣科，你们轻轻松松写下了一个悲剧。

或者当你得知从事科学的初恋也登上飞船，你开始关注哈尔的用户在漫长星际旅行中的寂寞，在哈尔多媒体系统中为每个宇航员准备一张喜欢的虾米歌单，飞船经过你们的故乡时哈尔给她发送一条当年的风景照。

#### 1.3. 活动

进入工程阶段后，对要解决的问题和技术手段的认识，越加清楚，对于她们的混合方式也有了新的看法，团队内不同角色并行流水线，每个人的日常活动耽于细节，却普遍缺乏回顾和反馈，这可能会导致需求、产品设计、软件设计、开发、测试的一系列活动来不及纠正、渐微偏离目标、失去做得更好的机会。

所以回答上面问题不仅仅有助于动手之前核对目标，也是行进途中不断给团队这台机器加机油、校准方向。

建议团队在腾讯文档中新建一个演示文档，插入表格，第一列填写问题，第二列填写答案，第三列填写思考。每天惦记着她们，有新的idea填写到第三列并记录日期，反复咀嚼后再更新第二列的答案，并落实到实际工作中。

### 2. 问题和程度

#### 2.1. 需求

产品需求来自产品经理，技术需求来自开发者。个人软件的需求则全部来自你自身，比如重写一个HTTP服务器。以敏捷中名词为例，无论需求从哪里来，作为开发者要认真思考需求的描述和验收标准：

1. 有无隐式的未知前提和约束？
2. 实现有哪些依赖？
3. 验收标准有无矛盾？
4. 如果有明显的多义性如未指明操作系统、浏览器类型、并发数量、响应时间、API实现数量、弹出A或B的顺序，需尽快反馈。
5. 新功能和现有系统有无矛盾，如何解决？
6. 实现这些验收标准，需要说明哪些前提、限制约束。
7. 开发完之后如何测试？

疑惑点要及时反馈给提出者，这个阶段的零星失误都可能导致延期。

#### 2.2. UI和UE

UI/UE充分表达了产品经理满足用户的品味，开发者应反复操作UE，揣摩产品经理的意图，顺应开发，遇到UE表达不充分的场景，自行决策时可以延续设计者理念。

没有UI的软件也需要考虑人机交互，比如命令行帮助、运行时命令交互。

### 3. 技术选型

几项原则：

1. 主流，简单。
2. 兼顾团队技术栈及发展。
3. 开源而不是闭源。社区火热，Github的Star数。
4. 兼顾遗留系统兼容性。
5. 够好而不是最好(很难评价)，不要炫技。技术为目标服务，快速迭代先检验目标的价值。

### 4. 数据采集

任何软件都要朝着目标的快速迭代来纠偏、改进方向，代码中要设计采集软件性能指标、运营指标的“探针”，通过日志或时序数据库保存，在离线提取后可通过UI显示分析结果。

### 5. 持续集成

参考[持续交付与Jenkins实践](https://hubugui.github.io/2019/10/03/%E6%8C%81%E7%BB%AD%E4%BA%A4%E4%BB%98%E4%B8%8EJenkins%E5%AE%9E%E8%B7%B5.html)，至少做到：

1. 自动构建，执行单元测试的自动化脚本。
2. 自动发布。
3. 自动部署，安装及运行。

### 6. 怎么测试？

#### 6.1. 测试用例

需求服务于用户，测试从需求出发，首先要站在用户角度，找出评价软件是否在前提和约束基础上达到以下目标的测试用例：

1. 是否解决了用户问题。
2. 问题的解决程度如性能是否符合验收标准。
3. 软件质量的六大性是否合理。

随后是再开展逐项检验。

#### 6.2. 自动化测试

开发者一定要多采用自动化测试方法，从而节省自己的时间去做更有价值的事，恰好自动化后也更容易回归定量定性的测试，即使放到线上环境也可以继续检验。目前对于UI的自动化测试都有许多方案，非UI软件，起码可以通过脚本模拟软件的输入和输出，并分析运行时日志来统计运行状态。

如果你认为某些需求无法自动化测试甚至无法测试，闲暇不妨看看技术书籍，科技新闻和科幻小说，没有做不到，只有想不到。

#### 6.3. 测试环境

ToC业务的后端软件大多部署在云上，规划好负载均衡、灾备的方案后，具备了实施类似金丝雀测试的基础，再结合自动化测试，不难自动统计出不同版本软件的质量和运营数据。前端软件如手机、PC端也有许多虚拟化手段，故搭建测试环境较为容易。

ToB业务很多非标准化的项目，往往得到用户现场才有测试环境，这对于开发者来说却是很糟糕，但也没有严重到要测试一款号称能在太阳表面运行的软件，试试如下办法：

1. 争取拿到依赖的第三方软件，在公司内试验。
2. 准备好软件及配套测试工具、用例，发给现场伙伴帮助检验，测试用例要得出定量、定性的结论，测试工具或日志等要给出明确结论。

### 7. 最后的最后

新软件如同新生儿，前期是孕育，部署使用后才是他的开始。

1. 再次审视**开始的开始**中的问题，评价使用体验和测试数据是否符合预期。我还可以做哪些？
2. 开发者是软件的父母，用户是软件的伴侣，谁也不希望费时费力制作的软件被他的伴侣嫌弃缺少管教。
3. 拿到性能和运营数据后，开展分析，评估产品上是否达到最初目标、技术上还有哪些优化空间。